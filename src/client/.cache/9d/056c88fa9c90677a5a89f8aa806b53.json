{"id":"wjcX","dependencies":[{"name":"/Users/oluwa/dev/vcs/.babelrc","includedInParent":true,"mtime":1553381488107},{"name":"/Users/oluwa/dev/vcs/package.json","includedInParent":true,"mtime":1560113129702},{"name":"./utils.js","loc":{"line":2,"column":22},"parent":"/Users/oluwa/dev/vcs/src/client/tts.js","resolved":"/Users/oluwa/dev/vcs/src/client/utils.js"},{"name":"./speech.js","loc":{"line":3,"column":24},"parent":"/Users/oluwa/dev/vcs/src/client/tts.js","resolved":"/Users/oluwa/dev/vcs/src/client/speech.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.is_speaking=o,exports.finished_speaking=p,exports.speak=a,exports.speech_que=exports.tts=void 0;var e=r(require(\"./utils.js\")),t=r(require(\"./speech.js\"));function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var s=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};s.get||s.set?Object.defineProperty(t,r,s):t[r]=e[r]}return t.default=e,t}let s=e.get_logger(\"tts\");var i=window.speechSynthesis;exports.tts=i;var n=[];function o(){return i.speaking}async function p(){return await e.loop_until_true(()=>!i.speaking,200,6e4)}async function a(e){if(s.d(\"Request to speak: \"+e),i.speaking)s.d(\"Scheduling speech for later.\"),n.push(e);else{t.stop_recognition();var r=new SpeechSynthesisUtterance(e);r.voice=i.getVoices()[49],r.rate=1.2,i.speak(r);await p();let s=n.shift();s?a(s):t.start_recognition()}}exports.speech_que=n;","map":{"mappings":[{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":0}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":13}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":20}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":35}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":43}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":56}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":57}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":64}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":68}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":76}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":88}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":90}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":98}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":116}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":118}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":126}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":132}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":134}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":142}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":153}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":161}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":170}},{"source":"tts.js","original":{"line":2,"column":0},"generated":{"line":1,"column":172}},{"source":"tts.js","original":{"line":2,"column":0},"generated":{"line":1,"column":176}},{"source":"tts.js","original":{"line":2,"column":0},"generated":{"line":1,"column":178}},{"source":"tts.js","original":{"line":2,"column":0},"generated":{"line":1,"column":180}},{"source":"tts.js","original":{"line":2,"column":0},"generated":{"line":1,"column":188}},{"source":"tts.js","original":{"line":3,"column":0},"generated":{"line":1,"column":203}},{"source":"tts.js","original":{"line":3,"column":0},"generated":{"line":1,"column":205}},{"source":"tts.js","original":{"line":3,"column":0},"generated":{"line":1,"column":207}},{"source":"tts.js","original":{"line":3,"column":0},"generated":{"line":1,"column":215}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":231}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":240}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":242}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":245}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":248}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":251}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":253}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":264}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":271}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":273}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":277}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":279}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":282}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":285}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":291}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":293}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":297}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":301}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":306}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":308}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":311}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":318}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":328}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":343}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":348}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":350}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":353}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":354}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":358}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":360}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":367}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":383}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":390}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":415}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":422}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":447}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":449}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":452}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":455}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":457}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":462}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":464}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":468}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":475}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":490}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":492}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":494}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":497}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":499}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":502}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":504}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":507}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":514}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":516}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":524}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":526}},{"source":"tts.js","original":{"line":5,"column":0},"generated":{"line":1,"column":528}},{"source":"tts.js","name":"log","original":{"line":5,"column":4},"generated":{"line":1,"column":532}},{"source":"tts.js","name":"util","original":{"line":5,"column":10},"generated":{"line":1,"column":534}},{"source":"tts.js","name":"get_logger","original":{"line":5,"column":15},"generated":{"line":1,"column":536}},{"source":"tts.js","original":{"line":5,"column":26},"generated":{"line":1,"column":547}},{"source":"tts.js","original":{"line":7,"column":7},"generated":{"line":1,"column":554}},{"source":"tts.js","name":"tts","original":{"line":7,"column":11},"generated":{"line":1,"column":558}},{"source":"tts.js","name":"window","original":{"line":7,"column":17},"generated":{"line":1,"column":560}},{"source":"tts.js","name":"speechSynthesis","original":{"line":7,"column":24},"generated":{"line":1,"column":567}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":583}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":591}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":595}},{"source":"tts.js","original":{"line":8,"column":7},"generated":{"line":1,"column":597}},{"source":"tts.js","name":"speech_que","original":{"line":8,"column":11},"generated":{"line":1,"column":601}},{"source":"tts.js","original":{"line":8,"column":24},"generated":{"line":1,"column":603}},{"source":"tts.js","original":{"line":10,"column":7},"generated":{"line":1,"column":606}},{"source":"tts.js","name":"is_speaking","original":{"line":10,"column":16},"generated":{"line":1,"column":615}},{"source":"tts.js","name":"tts","original":{"line":11,"column":11},"generated":{"line":1,"column":619}},{"source":"tts.js","name":"tts","original":{"line":11,"column":11},"generated":{"line":1,"column":626}},{"source":"tts.js","name":"speaking","original":{"line":11,"column":15},"generated":{"line":1,"column":628}},{"source":"tts.js","original":{"line":14,"column":7},"generated":{"line":1,"column":637}},{"source":"tts.js","name":"finished_speaking","original":{"line":14,"column":22},"generated":{"line":1,"column":652}},{"source":"tts.js","name":"timeout","original":{"line":16,"column":11},"generated":{"line":1,"column":656}},{"source":"tts.js","name":"util","original":{"line":15,"column":24},"generated":{"line":1,"column":669}},{"source":"tts.js","name":"loop_until_true","original":{"line":15,"column":29},"generated":{"line":1,"column":671}},{"source":"tts.js","original":{"line":15,"column":45},"generated":{"line":1,"column":687}},{"source":"tts.js","name":"tts","original":{"line":15,"column":50},"generated":{"line":1,"column":692}},{"source":"tts.js","name":"speaking","original":{"line":15,"column":54},"generated":{"line":1,"column":694}},{"source":"tts.js","original":{"line":15,"column":63},"generated":{"line":1,"column":703}},{"source":"tts.js","original":{"line":15,"column":67},"generated":{"line":1,"column":707}},{"source":"tts.js","original":{"line":19,"column":7},"generated":{"line":1,"column":712}},{"source":"tts.js","name":"speak","original":{"line":19,"column":22},"generated":{"line":1,"column":727}},{"source":"tts.js","name":"text","original":{"line":19,"column":28},"generated":{"line":1,"column":729}},{"source":"tts.js","original":{"line":21,"column":8},"generated":{"line":1,"column":732}},{"source":"tts.js","name":"log","original":{"line":20,"column":4},"generated":{"line":1,"column":735}},{"source":"tts.js","name":"d","original":{"line":20,"column":8},"generated":{"line":1,"column":737}},{"source":"tts.js","original":{"line":20,"column":10},"generated":{"line":1,"column":739}},{"source":"tts.js","name":"text","original":{"line":20,"column":33},"generated":{"line":1,"column":760}},{"source":"tts.js","name":"tts","original":{"line":21,"column":10},"generated":{"line":1,"column":763}},{"source":"tts.js","name":"speaking","original":{"line":21,"column":14},"generated":{"line":1,"column":765}},{"source":"tts.js","name":"log","original":{"line":34,"column":1},"generated":{"line":1,"column":774}},{"source":"tts.js","name":"d","original":{"line":34,"column":5},"generated":{"line":1,"column":776}},{"source":"tts.js","original":{"line":34,"column":7},"generated":{"line":1,"column":778}},{"source":"tts.js","name":"speech_que","original":{"line":35,"column":1},"generated":{"line":1,"column":810}},{"source":"tts.js","name":"push","original":{"line":35,"column":12},"generated":{"line":1,"column":812}},{"source":"tts.js","name":"text","original":{"line":35,"column":17},"generated":{"line":1,"column":817}},{"source":"tts.js","original":{"line":21,"column":24},"generated":{"line":1,"column":824}},{"source":"tts.js","name":"speech","original":{"line":22,"column":1},"generated":{"line":1,"column":825}},{"source":"tts.js","name":"stop_recognition","original":{"line":22,"column":8},"generated":{"line":1,"column":827}},{"source":"tts.js","name":"utterance","original":{"line":23,"column":5},"generated":{"line":1,"column":846}},{"source":"tts.js","name":"utterance","original":{"line":23,"column":5},"generated":{"line":1,"column":850}},{"source":"tts.js","original":{"line":23,"column":18},"generated":{"line":1,"column":852}},{"source":"tts.js","name":"SpeechSynthesisUtterance","original":{"line":23,"column":22},"generated":{"line":1,"column":856}},{"source":"tts.js","name":"text","original":{"line":23,"column":47},"generated":{"line":1,"column":881}},{"source":"tts.js","name":"utterance","original":{"line":24,"column":1},"generated":{"line":1,"column":884}},{"source":"tts.js","name":"voice","original":{"line":24,"column":11},"generated":{"line":1,"column":886}},{"source":"tts.js","name":"tts","original":{"line":24,"column":19},"generated":{"line":1,"column":892}},{"source":"tts.js","name":"getVoices","original":{"line":24,"column":23},"generated":{"line":1,"column":894}},{"source":"tts.js","original":{"line":24,"column":35},"generated":{"line":1,"column":906}},{"source":"tts.js","name":"utterance","original":{"line":26,"column":1},"generated":{"line":1,"column":910}},{"source":"tts.js","name":"rate","original":{"line":26,"column":11},"generated":{"line":1,"column":912}},{"source":"tts.js","original":{"line":26,"column":18},"generated":{"line":1,"column":917}},{"source":"tts.js","name":"tts","original":{"line":27,"column":1},"generated":{"line":1,"column":921}},{"source":"tts.js","name":"speak","original":{"line":27,"column":5},"generated":{"line":1,"column":923}},{"source":"tts.js","name":"utterance","original":{"line":27,"column":11},"generated":{"line":1,"column":929}},{"source":"tts.js","name":"finished_speaking","original":{"line":28,"column":15},"generated":{"line":1,"column":938}},{"source":"tts.js","name":"_","original":{"line":28,"column":5},"generated":{"line":1,"column":942}},{"source":"tts.js","name":"next","original":{"line":29,"column":5},"generated":{"line":1,"column":946}},{"source":"tts.js","name":"speech_que","original":{"line":29,"column":12},"generated":{"line":1,"column":948}},{"source":"tts.js","name":"shift","original":{"line":29,"column":23},"generated":{"line":1,"column":950}},{"source":"tts.js","name":"next","original":{"line":30,"column":5},"generated":{"line":1,"column":958}},{"source":"tts.js","name":"speak","original":{"line":30,"column":13},"generated":{"line":1,"column":960}},{"source":"tts.js","name":"next","original":{"line":30,"column":19},"generated":{"line":1,"column":962}},{"source":"tts.js","name":"speech","original":{"line":31,"column":5},"generated":{"line":1,"column":965}},{"source":"tts.js","name":"start_recognition","original":{"line":31,"column":12},"generated":{"line":1,"column":967}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":988}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":996}},{"source":"tts.js","original":{"line":37,"column":1},"generated":{"line":1,"column":1007}}],"sources":{"tts.js":"//Sun Mar  3 16:01:13 PST 2019\nimport * as util from \"./utils.js\" \nimport * as speech from \"./speech.js\"\n\nlet log = util.get_logger(\"tts\") \n\nexport var tts = window.speechSynthesis;\nexport var speech_que = []\n\nexport function is_speaking() { \n    return tts.speaking\n}\n\nexport async function finished_speaking() {\n    let timeout = await util.loop_until_true(()=>!tts.speaking,200,1000*60)\n    return timeout \n}\n\nexport async function speak(text) { \n    log.d(\"Request to speak: \" + text) \n    if (! tts.speaking) { \n\tspeech.stop_recognition()\n\tvar utterance  = new SpeechSynthesisUtterance(text);\n\tutterance.voice = tts.getVoices()[49] \n\t//utterance.pitch = pitch.value;\n\tutterance.rate = 1.2;\n\ttts.speak(utterance); \n\tlet _ = await finished_speaking() \n\tlet next = speech_que.shift() \n\tif (next) { speak(next) } else { \n\t    speech.start_recognition()\n\t}\n    } else { \n\tlog.d(\"Scheduling speech for later.\")\n\tspeech_que.push(text)\n    }\n}\n\n\n\n"},"lineCount":null}},"hash":"7df17a7f59cf874a9c102265ff0d6274","cacheData":{"env":{}}}