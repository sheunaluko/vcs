{"id":"H8qx","dependencies":[{"name":"/Users/oluwa/dev/vcs/.babelrc","includedInParent":true,"mtime":1551642373535},{"name":"/Users/oluwa/dev/vcs/package.json","includedInParent":true,"mtime":1551648202855},{"name":"./audio_detector.js","loc":{"line":1,"column":20},"parent":"/Users/oluwa/dev/vcs/src/client/speech.js","resolved":"/Users/oluwa/dev/vcs/src/client/audio_detector.js"},{"name":"./utils.js","loc":{"line":2,"column":25},"parent":"/Users/oluwa/dev/vcs/src/client/speech.js","resolved":"/Users/oluwa/dev/vcs/src/client/utils.js"},{"name":"./tts.js","loc":{"line":3,"column":21},"parent":"/Users/oluwa/dev/vcs/src/client/speech.js","resolved":"/Users/oluwa/dev/vcs/src/client/tts.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.connect_ws=c,exports.start_recognition=d,exports.stop_recognition=p,exports.start_audio_trigger=l,exports.recognition=void 0;var t=o(require(\"./audio_detector.js\")),e=require(\"./utils.js\"),n=o(require(\"./tts.js\"));function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};o.get||o.set?Object.defineProperty(e,n,o):e[n]=t[n]}return e.default=t,e}let r=(0,e.get_logger)(\"speech\"),i=9001;var s=null;function c(){r.i(\"Connecting ws on port: \"+i);var t=new WebSocket(\"ws://localhost:\"+i);t.addEventListener(\"open\",()=>r.i(\"WS connection opened\")),t.addEventListener(\"message\",t=>{let e=JSON.parse(t.data);r.d(\"Got ws msg:\"),r.d(e),\"speak\"==e.type&&n.speak(e.text)}),s=function(e){t.send(JSON.stringify({type:\"vcs_text\",text:e}))}}var u=new webkitSpeechRecognition;exports.recognition=u,u.continuous=!0,u.interimResults=!1,u.onstart=function(){r.i(\"Recognition starting\")},u.onsoundstart=function(){},u.onresult=function(t){r.d(\"Got recognition result\"),r.d(t);let e=t.results[t.resultIndex][0].transcript;s(e)},u.onerror=function(t){r.d(\"Recognition error:\"),r.d(t)},u.onend=function(){r.i(\"Recognition ended\"),a=!1};var a=!1;function d(){a||(r.d(\"Starting recognition.\"),u.start(),a=!0)}function p(){u.abort(),a=!1}async function g(t){}function l(){t.start(d)}","map":{"mappings":[{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":0}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":13}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":20}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":35}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":43}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":56}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":57}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":64}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":68}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":76}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":87}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":89}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":97}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":115}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":117}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":125}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":142}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":144}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":152}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":172}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":174}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":182}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":199}},{"source":"speech.js","original":{"line":1,"column":0},"generated":{"line":1,"column":201}},{"source":"speech.js","original":{"line":1,"column":0},"generated":{"line":1,"column":205}},{"source":"speech.js","original":{"line":1,"column":0},"generated":{"line":1,"column":207}},{"source":"speech.js","original":{"line":1,"column":0},"generated":{"line":1,"column":209}},{"source":"speech.js","original":{"line":1,"column":0},"generated":{"line":1,"column":217}},{"source":"speech.js","original":{"line":2,"column":0},"generated":{"line":1,"column":241}},{"source":"speech.js","original":{"line":2,"column":0},"generated":{"line":1,"column":243}},{"source":"speech.js","original":{"line":2,"column":0},"generated":{"line":1,"column":251}},{"source":"speech.js","original":{"line":3,"column":0},"generated":{"line":1,"column":265}},{"source":"speech.js","original":{"line":3,"column":0},"generated":{"line":1,"column":267}},{"source":"speech.js","original":{"line":3,"column":0},"generated":{"line":1,"column":269}},{"source":"speech.js","original":{"line":3,"column":0},"generated":{"line":1,"column":277}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":290}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":299}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":301}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":304}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":307}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":310}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":312}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":323}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":330}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":332}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":336}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":338}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":341}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":344}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":350}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":352}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":356}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":360}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":365}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":367}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":370}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":377}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":387}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":402}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":407}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":409}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":412}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":413}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":417}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":419}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":426}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":442}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":449}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":474}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":481}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":506}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":508}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":511}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":514}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":516}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":521}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":523}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":527}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":534}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":549}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":551}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":553}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":556}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":558}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":561}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":563}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":566}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":573}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":575}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":583}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":585}},{"source":"speech.js","original":{"line":5,"column":0},"generated":{"line":1,"column":587}},{"source":"speech.js","name":"log","original":{"line":5,"column":4},"generated":{"line":1,"column":591}},{"source":"speech.js","original":{"line":5,"column":10},"generated":{"line":1,"column":594}},{"source":"speech.js","original":{"line":5,"column":21},"generated":{"line":1,"column":596}},{"source":"speech.js","original":{"line":5,"column":21},"generated":{"line":1,"column":598}},{"source":"speech.js","original":{"line":5,"column":21},"generated":{"line":1,"column":610}},{"source":"speech.js","name":"ws_port","original":{"line":8,"column":4},"generated":{"line":1,"column":620}},{"source":"speech.js","original":{"line":8,"column":14},"generated":{"line":1,"column":622}},{"source":"speech.js","original":{"line":9,"column":0},"generated":{"line":1,"column":627}},{"source":"speech.js","name":"send_text","original":{"line":9,"column":4},"generated":{"line":1,"column":631}},{"source":"speech.js","original":{"line":9,"column":16},"generated":{"line":1,"column":633}},{"source":"speech.js","original":{"line":12,"column":7},"generated":{"line":1,"column":638}},{"source":"speech.js","name":"connect_ws","original":{"line":12,"column":16},"generated":{"line":1,"column":647}},{"source":"speech.js","name":"log","original":{"line":13,"column":4},"generated":{"line":1,"column":651}},{"source":"speech.js","name":"i","original":{"line":13,"column":8},"generated":{"line":1,"column":653}},{"source":"speech.js","original":{"line":13,"column":10},"generated":{"line":1,"column":655}},{"source":"speech.js","name":"ws_port","original":{"line":13,"column":38},"generated":{"line":1,"column":681}},{"source":"speech.js","name":"ws","original":{"line":14,"column":8},"generated":{"line":1,"column":684}},{"source":"speech.js","name":"ws","original":{"line":14,"column":8},"generated":{"line":1,"column":688}},{"source":"speech.js","original":{"line":14,"column":13},"generated":{"line":1,"column":690}},{"source":"speech.js","name":"WebSocket","original":{"line":14,"column":17},"generated":{"line":1,"column":694}},{"source":"speech.js","original":{"line":14,"column":27},"generated":{"line":1,"column":704}},{"source":"speech.js","name":"ws_port","original":{"line":14,"column":45},"generated":{"line":1,"column":722}},{"source":"speech.js","name":"ws","original":{"line":15,"column":4},"generated":{"line":1,"column":725}},{"source":"speech.js","name":"addEventListener","original":{"line":15,"column":7},"generated":{"line":1,"column":727}},{"source":"speech.js","original":{"line":15,"column":24},"generated":{"line":1,"column":744}},{"source":"speech.js","original":{"line":15,"column":33},"generated":{"line":1,"column":751}},{"source":"speech.js","name":"log","original":{"line":15,"column":38},"generated":{"line":1,"column":755}},{"source":"speech.js","name":"i","original":{"line":15,"column":42},"generated":{"line":1,"column":757}},{"source":"speech.js","original":{"line":15,"column":44},"generated":{"line":1,"column":759}},{"source":"speech.js","name":"ws","original":{"line":16,"column":4},"generated":{"line":1,"column":784}},{"source":"speech.js","name":"addEventListener","original":{"line":16,"column":7},"generated":{"line":1,"column":786}},{"source":"speech.js","original":{"line":16,"column":24},"generated":{"line":1,"column":803}},{"source":"speech.js","name":"m","original":{"line":16,"column":36},"generated":{"line":1,"column":813}},{"source":"speech.js","name":"msg","original":{"line":17,"column":5},"generated":{"line":1,"column":817}},{"source":"speech.js","name":"msg","original":{"line":17,"column":5},"generated":{"line":1,"column":821}},{"source":"speech.js","name":"JSON","original":{"line":17,"column":11},"generated":{"line":1,"column":823}},{"source":"speech.js","name":"parse","original":{"line":17,"column":16},"generated":{"line":1,"column":828}},{"source":"speech.js","name":"m","original":{"line":17,"column":22},"generated":{"line":1,"column":834}},{"source":"speech.js","name":"data","original":{"line":17,"column":24},"generated":{"line":1,"column":836}},{"source":"speech.js","name":"log","original":{"line":18,"column":1},"generated":{"line":1,"column":842}},{"source":"speech.js","name":"d","original":{"line":18,"column":5},"generated":{"line":1,"column":844}},{"source":"speech.js","original":{"line":18,"column":7},"generated":{"line":1,"column":846}},{"source":"speech.js","name":"log","original":{"line":19,"column":1},"generated":{"line":1,"column":861}},{"source":"speech.js","name":"d","original":{"line":19,"column":5},"generated":{"line":1,"column":863}},{"source":"speech.js","name":"msg","original":{"line":19,"column":7},"generated":{"line":1,"column":865}},{"source":"speech.js","original":{"line":20,"column":17},"generated":{"line":1,"column":868}},{"source":"speech.js","name":"msg","original":{"line":20,"column":5},"generated":{"line":1,"column":877}},{"source":"speech.js","name":"type","original":{"line":20,"column":9},"generated":{"line":1,"column":879}},{"source":"speech.js","name":"tts","original":{"line":21,"column":5},"generated":{"line":1,"column":885}},{"source":"speech.js","name":"speak","original":{"line":21,"column":9},"generated":{"line":1,"column":887}},{"source":"speech.js","name":"msg","original":{"line":21,"column":15},"generated":{"line":1,"column":893}},{"source":"speech.js","name":"text","original":{"line":21,"column":19},"generated":{"line":1,"column":895}},{"source":"speech.js","name":"send_text","original":{"line":24,"column":4},"generated":{"line":1,"column":903}},{"source":"speech.js","original":{"line":24,"column":16},"generated":{"line":1,"column":905}},{"source":"speech.js","name":"text","original":{"line":24,"column":26},"generated":{"line":1,"column":914}},{"source":"speech.js","name":"ws","original":{"line":26,"column":1},"generated":{"line":1,"column":917}},{"source":"speech.js","name":"send","original":{"line":26,"column":4},"generated":{"line":1,"column":919}},{"source":"speech.js","name":"JSON","original":{"line":26,"column":9},"generated":{"line":1,"column":924}},{"source":"speech.js","name":"stringify","original":{"line":26,"column":14},"generated":{"line":1,"column":929}},{"source":"speech.js","original":{"line":26,"column":24},"generated":{"line":1,"column":939}},{"source":"speech.js","name":"type","original":{"line":26,"column":26},"generated":{"line":1,"column":940}},{"source":"speech.js","original":{"line":25,"column":12},"generated":{"line":1,"column":945}},{"source":"speech.js","name":"text","original":{"line":26,"column":32},"generated":{"line":1,"column":956}},{"source":"speech.js","name":"text","original":{"line":26,"column":32},"generated":{"line":1,"column":961}},{"source":"speech.js","original":{"line":32,"column":7},"generated":{"line":1,"column":967}},{"source":"speech.js","name":"recognition","original":{"line":32,"column":11},"generated":{"line":1,"column":971}},{"source":"speech.js","original":{"line":32,"column":25},"generated":{"line":1,"column":973}},{"source":"speech.js","name":"webkitSpeechRecognition","original":{"line":32,"column":29},"generated":{"line":1,"column":977}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":1001}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":1009}},{"source":"speech.js","original":{"line":81,"column":1},"generated":{"line":1,"column":1021}},{"source":"speech.js","name":"recognition","original":{"line":33,"column":0},"generated":{"line":1,"column":1023}},{"source":"speech.js","name":"continuous","original":{"line":33,"column":12},"generated":{"line":1,"column":1025}},{"source":"speech.js","original":{"line":33,"column":25},"generated":{"line":1,"column":1037}},{"source":"speech.js","name":"recognition","original":{"line":34,"column":0},"generated":{"line":1,"column":1039}},{"source":"speech.js","name":"interimResults","original":{"line":34,"column":12},"generated":{"line":1,"column":1041}},{"source":"speech.js","original":{"line":34,"column":29},"generated":{"line":1,"column":1057}},{"source":"speech.js","name":"recognition","original":{"line":35,"column":0},"generated":{"line":1,"column":1059}},{"source":"speech.js","name":"onstart","original":{"line":35,"column":12},"generated":{"line":1,"column":1061}},{"source":"speech.js","original":{"line":35,"column":22},"generated":{"line":1,"column":1069}},{"source":"speech.js","name":"log","original":{"line":36,"column":4},"generated":{"line":1,"column":1080}},{"source":"speech.js","name":"i","original":{"line":36,"column":8},"generated":{"line":1,"column":1082}},{"source":"speech.js","original":{"line":36,"column":10},"generated":{"line":1,"column":1084}},{"source":"speech.js","name":"recognition","original":{"line":39,"column":0},"generated":{"line":1,"column":1109}},{"source":"speech.js","name":"onsoundstart","original":{"line":39,"column":12},"generated":{"line":1,"column":1111}},{"source":"speech.js","original":{"line":39,"column":27},"generated":{"line":1,"column":1124}},{"source":"speech.js","name":"recognition","original":{"line":43,"column":0},"generated":{"line":1,"column":1137}},{"source":"speech.js","name":"onresult","original":{"line":43,"column":12},"generated":{"line":1,"column":1139}},{"source":"speech.js","original":{"line":43,"column":23},"generated":{"line":1,"column":1148}},{"source":"speech.js","name":"event","original":{"line":43,"column":32},"generated":{"line":1,"column":1157}},{"source":"speech.js","name":"log","original":{"line":44,"column":4},"generated":{"line":1,"column":1160}},{"source":"speech.js","name":"d","original":{"line":44,"column":8},"generated":{"line":1,"column":1162}},{"source":"speech.js","original":{"line":44,"column":10},"generated":{"line":1,"column":1164}},{"source":"speech.js","name":"log","original":{"line":45,"column":4},"generated":{"line":1,"column":1190}},{"source":"speech.js","name":"d","original":{"line":45,"column":8},"generated":{"line":1,"column":1192}},{"source":"speech.js","name":"event","original":{"line":45,"column":10},"generated":{"line":1,"column":1194}},{"source":"speech.js","name":"text","original":{"line":46,"column":8},"generated":{"line":1,"column":1197}},{"source":"speech.js","name":"text","original":{"line":46,"column":8},"generated":{"line":1,"column":1201}},{"source":"speech.js","name":"event","original":{"line":46,"column":15},"generated":{"line":1,"column":1203}},{"source":"speech.js","name":"results","original":{"line":46,"column":21},"generated":{"line":1,"column":1205}},{"source":"speech.js","name":"event","original":{"line":46,"column":29},"generated":{"line":1,"column":1213}},{"source":"speech.js","name":"resultIndex","original":{"line":46,"column":35},"generated":{"line":1,"column":1215}},{"source":"speech.js","original":{"line":46,"column":48},"generated":{"line":1,"column":1228}},{"source":"speech.js","name":"transcript","original":{"line":46,"column":51},"generated":{"line":1,"column":1231}},{"source":"speech.js","name":"send_text","original":{"line":47,"column":4},"generated":{"line":1,"column":1242}},{"source":"speech.js","name":"text","original":{"line":47,"column":14},"generated":{"line":1,"column":1244}},{"source":"speech.js","name":"recognition","original":{"line":49,"column":0},"generated":{"line":1,"column":1248}},{"source":"speech.js","name":"onerror","original":{"line":49,"column":12},"generated":{"line":1,"column":1250}},{"source":"speech.js","original":{"line":49,"column":22},"generated":{"line":1,"column":1258}},{"source":"speech.js","name":"event","original":{"line":49,"column":31},"generated":{"line":1,"column":1267}},{"source":"speech.js","name":"log","original":{"line":50,"column":4},"generated":{"line":1,"column":1270}},{"source":"speech.js","name":"d","original":{"line":50,"column":8},"generated":{"line":1,"column":1272}},{"source":"speech.js","original":{"line":50,"column":10},"generated":{"line":1,"column":1274}},{"source":"speech.js","name":"log","original":{"line":51,"column":4},"generated":{"line":1,"column":1296}},{"source":"speech.js","name":"d","original":{"line":51,"column":8},"generated":{"line":1,"column":1298}},{"source":"speech.js","name":"event","original":{"line":51,"column":10},"generated":{"line":1,"column":1300}},{"source":"speech.js","name":"recognition","original":{"line":53,"column":0},"generated":{"line":1,"column":1304}},{"source":"speech.js","name":"onend","original":{"line":53,"column":12},"generated":{"line":1,"column":1306}},{"source":"speech.js","original":{"line":53,"column":20},"generated":{"line":1,"column":1312}},{"source":"speech.js","name":"log","original":{"line":54,"column":4},"generated":{"line":1,"column":1323}},{"source":"speech.js","name":"i","original":{"line":54,"column":8},"generated":{"line":1,"column":1325}},{"source":"speech.js","original":{"line":54,"column":10},"generated":{"line":1,"column":1327}},{"source":"speech.js","name":"is_started","original":{"line":55,"column":4},"generated":{"line":1,"column":1348}},{"source":"speech.js","original":{"line":55,"column":17},"generated":{"line":1,"column":1351}},{"source":"speech.js","original":{"line":58,"column":0},"generated":{"line":1,"column":1354}},{"source":"speech.js","name":"is_started","original":{"line":58,"column":4},"generated":{"line":1,"column":1358}},{"source":"speech.js","original":{"line":58,"column":17},"generated":{"line":1,"column":1361}},{"source":"speech.js","original":{"line":59,"column":7},"generated":{"line":1,"column":1363}},{"source":"speech.js","name":"start_recognition","original":{"line":59,"column":16},"generated":{"line":1,"column":1372}},{"source":"speech.js","name":"is_started","original":{"line":60,"column":9},"generated":{"line":1,"column":1376}},{"source":"speech.js","name":"log","original":{"line":61,"column":1},"generated":{"line":1,"column":1380}},{"source":"speech.js","name":"d","original":{"line":61,"column":5},"generated":{"line":1,"column":1382}},{"source":"speech.js","original":{"line":61,"column":7},"generated":{"line":1,"column":1384}},{"source":"speech.js","name":"recognition","original":{"line":62,"column":1},"generated":{"line":1,"column":1409}},{"source":"speech.js","name":"start","original":{"line":62,"column":13},"generated":{"line":1,"column":1411}},{"source":"speech.js","name":"is_started","original":{"line":63,"column":1},"generated":{"line":1,"column":1419}},{"source":"speech.js","original":{"line":63,"column":14},"generated":{"line":1,"column":1422}},{"source":"speech.js","original":{"line":67,"column":7},"generated":{"line":1,"column":1425}},{"source":"speech.js","name":"stop_recognition","original":{"line":67,"column":16},"generated":{"line":1,"column":1434}},{"source":"speech.js","name":"recognition","original":{"line":68,"column":4},"generated":{"line":1,"column":1438}},{"source":"speech.js","name":"abort","original":{"line":68,"column":16},"generated":{"line":1,"column":1440}},{"source":"speech.js","name":"is_started","original":{"line":69,"column":4},"generated":{"line":1,"column":1448}},{"source":"speech.js","original":{"line":69,"column":17},"generated":{"line":1,"column":1451}},{"source":"speech.js","original":{"line":73,"column":0},"generated":{"line":1,"column":1453}},{"source":"speech.js","name":"speak","original":{"line":73,"column":15},"generated":{"line":1,"column":1468}},{"source":"speech.js","name":"text","original":{"line":73,"column":21},"generated":{"line":1,"column":1470}},{"source":"speech.js","original":{"line":79,"column":7},"generated":{"line":1,"column":1474}},{"source":"speech.js","name":"start_audio_trigger","original":{"line":79,"column":16},"generated":{"line":1,"column":1483}},{"source":"speech.js","name":"ad","original":{"line":80,"column":4},"generated":{"line":1,"column":1487}},{"source":"speech.js","name":"start","original":{"line":80,"column":7},"generated":{"line":1,"column":1489}},{"source":"speech.js","name":"start_recognition","original":{"line":80,"column":13},"generated":{"line":1,"column":1495}}],"sources":{"speech.js":"import * as ad from \"./audio_detector.js\" \nimport {get_logger} from \"./utils.js\" \nimport * as tts from \"./tts.js\" \n\nlet log = get_logger(\"speech\") \n\n/* params  */ \nlet ws_port = 9001\nvar send_text = null \n\n/* create websocket for relaying speech info */\nexport function connect_ws() { \n    log.i(\"Connecting ws on port: \" + ws_port) \n    var ws = new WebSocket(\"ws://localhost:\"+ws_port) \n    ws.addEventListener('open' , ()=> log.i(\"WS connection opened\") ) \n    ws.addEventListener('message', (m)=> {\n\tlet msg = JSON.parse(m.data) \n\tlog.d(\"Got ws msg:\") ;\n\tlog.d(msg)\n\tif (msg.type == 'speak' ) { \n\t    tts.speak(msg.text) \n\t}\n    }) \n    send_text = function (text) { \n\tlet type = 'vcs_text' \n\tws.send(JSON.stringify({ type, text }) ) \n    } \n}\n    \n\n/* Create recognition object */ \nexport var recognition = new webkitSpeechRecognition();\nrecognition.continuous = true\nrecognition.interimResults = false\nrecognition.onstart = function() {\n    log.i(\"Recognition starting\") \n}\n    \nrecognition.onsoundstart = function() {\n    //log.d(\"Sound started.\")\n}\n\nrecognition.onresult = function(event) { \n    log.d(\"Got recognition result\") \n    log.d(event) \n    let text = event.results[event.resultIndex][0].transcript\n    send_text(text) \n}\nrecognition.onerror = function(event) { \n    log.d(\"Recognition error:\")\n    log.d(event) \n}\nrecognition.onend = function() {  \n    log.i(\"Recognition ended\")\n    is_started = false \n} \n\nvar is_started = false \nexport function start_recognition() {\n    if (!is_started) {\n\tlog.d(\"Starting recognition.\") \n\trecognition.start() \n\tis_started = true \n    } \n}\n\nexport function stop_recognition() { \n    recognition.abort()    \n    is_started = false \n}\n\n/* interface to tts */ \nasync function speak(text) { \n    \n}\n\n\n/* trigger recognition when audio is detected */ \nexport function start_audio_trigger() { \n    ad.start(start_recognition) \n}\n\n\n\n"},"lineCount":null}},"hash":"a2b0cf38a804f8cbb2d81edd0833b78a","cacheData":{"env":{}}}